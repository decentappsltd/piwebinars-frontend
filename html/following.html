<!DOCTYPE html>
<html>

<head>
  <!--Scripts-->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://kit.fontawesome.com/3aea44e36d.js" crossorigin="anonymous"></script>

  <!--CSS-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" id="dark">
  <link rel="icon" type="image/png" href="/img/logo.png">

  <!--Google Fonts-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;700&display=swap" rel="stylesheet">
</head>

<body>
  <h1>Pi Webinars</h1>

  <nav class="footer" style="z-index: 100">
    <ul class="ul">
      <div class="mobile">
        <li class="li"><a class="a" href="/index.html"><img src="https://app.piwebinars.co.uk/img/Home_Icon.png" width="30px;">Home</a></li>
        <li class="li"><a class="a" href="./all-webinars.html"><img src="https://www.piwebinars.co.uk/img/Watch_Icon.png" width="30px;">Webinars</a></li>
        <li class="li"><a class="a" href="./upload.html"><img src="https://app.piwebinars.co.uk/img/Upload_Icon.png" width="30px;">Upload</a></li>
        <li class="li"><a class="a" href="./profile.html"><img src="https://app.piwebinars.co.uk/img/Profile_Icon.png" width="30px;">Profile</a></li>
    </ul>
    </div>
    <div class="row footer desktop">
      <img height="60" onclick="location.href='/'" style="position:relative;top:0;display: inline; float: left;" src="https://app.piwebinars.co.uk/img/logo-text.png" alt="logo"></img>

      <div style="float:right">
        <li class="li"><a class="a" href="/index.html"><img src="https://app.piwebinars.co.uk/img/Home_Icon.png" width="40px;">Home</a></li>
        <li class="li"><a class="a" href="./search.html"><img src="https://app.piwebinars.co.uk/img/Search_Icon.png" width="40px;">Search</a></li>
        <li class="li"><a class="a authNav" href="./upload.html"><img src="https://app.piwebinars.co.uk/img/Upload_Icon.png" width="40px;">Upload</a></li>
        <li class="li"><a class="a authNav" href="./profile.html"><img src="https://app.piwebinars.co.uk/img/Profile_Icon.png" width="40px;">Profile</a></li>
      </div>
    </div>
  </nav>

  <!--   Floating tab -->
  <div id="back-float">
    <a class="fas fa-arrow-left" style="color: #36454f;"  onclick="history.back()"></a>
  </div>

  <h2>Following:</h2>

  <div class="yourSection"></div><br><br><br>
  
  <script src="/js/pages/authentication.js"></script>
  <script>
    function render_following(uploadsObj) {
      const postSection = document.querySelector(".yourSection");
      const following = uploadsObj["data"]["profile"]["following"];
      for (const creator of following) {
        const renderDiv = document.createElement("article");
        const renderTitle = document.createElement("h3");
        renderDiv.className = "title";
        renderDiv.onclick = function() {
          localStorage.setItem("user_id", creator.user);
          window.location.href = "/html/userProfile.html";
        };
        renderTitle.textContent = creator.handle;
        renderDiv.appendChild(renderTitle);
        postSection.appendChild(renderDiv);
      };
    }
    async function renderFollowing() {
      const auth_token = localStorage.getItem("userSession");
      const profile = await axios.get(`https://piwebinarsdev.herokuapp.com/profile`, {
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${auth_token}`,
        },
      });
      render_following(profile);
    }
    renderFollowing();
  </script>
  <br><br><br>
</body>

</html>