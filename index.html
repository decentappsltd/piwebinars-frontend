<!DOCTYPE html>
<html>
  <head>
    
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KRPNL55');</script>
<!-- End Google Tag Manager -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2N939D6C1C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2N939D6C1C');
</script>
    
<meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, user-scalable=yes">
        
        <!-- ios support -->
        <meta name="apple-mobile-web-app-status-bar" content="#db4938" />
        <meta name="theme-color" content="#db4938" />
        
        <meta name="application-name" content="Pi Example">

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="assets/js/html5shiv-pre3.6.js"></script>
        <![endif]-->
        
        <script type="text/javascript" src="jquery-3.5.1.min.js"></script>
        <!--<script src="https://downloads.minepi.com/sdk/v1/dev.js"></script>-->
        <!--<script src="https://downloads.minepi.com/sdk/v1/prod.js"></script>-->
        <script src="https://sdk.minepi.com/pi-sdk.js"></script>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="icon" 
      type="image/png" 
      href="../img/logo.png">
    
    <script>
      if(navigator.userAgent.toLowerCase().indexOf("pibrowser")<0) document.domain!="localhost"&&window.open(window.location.protocol+"//"+document.domain+"/html/home.html","_self");
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@500;700&display=swap" rel="stylesheet">
  
  </head>
  <body>
    
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KRPNL55"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    
<!--    <script>               
const scopes = ['payments', 'username'];

function onIncompletePaymentFound(payment) { 
};

Pi.authenticate(scopes, onIncompletePaymentFound).then(function(auth) {
  document.getElementById('username').innerHTML = auth.user.username;
  console.log(`Hi there! Youre ready to make payments!`);
}).catch(function(error) {
  console.error(error);
});
</script>

<script>
  async function payPi () {
const axios = require('axios');
  
const paymentResult = await window.Pi.createPayment(paymentData, callbacks);
  
const axiosClient = axios.create({baseURL: "https://pi-webinars.herokuapp.com", timeout: 20000});
  
const config = {headers: {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'}};

onReadyForServerApproval = (paymentId: string) => {
  console.log("onReadyForServerApproval", paymentId);
  return axiosClient.post('/approve', {paymentId}, config);
} 

onReadyForServerCompletion = (paymentId: string, txid: string) => {
  console.log("onReadyForServerCompletion", paymentId);
  return axiosClient.post('/complete', {paymentId}, config);
}

onCancel = (paymentId: string) => {
  console.log("onCancel", paymentId);
  return axiosClient.post('/cancel', {paymentId}, config);
}

onIncompletePaymentFound = (payment: paymentDTO) => {
  console.log("onIncompletePaymentFound", paymentId);
  return axiosClient.post('/incomplete', {paymentId}, config);
}

onError = (error: Error, payment?: PaymentDTO) => {
  console.log("onError", error);
    console.log(payment);
    return axiosClient.post('/incomplete', {paymentId}, config);
}

const paymentData = {
  amount: 1, 
  memo: "webinar", 
  metadata: {productId: `${id}`}
  };
  
const callbacks = {
  onReadyForServerApproval: this.onReadyForServerApproval,
  onReadyForServerCompletion: this.onReadyForServerCompletion,
  onCancel: this.onCancel,
  onError: this.onError,
};
  };
        </script>-->
    
    <script type="text/javascript">
            $( document ).ready(function() {
                const Pi = window.Pi;
                Pi.init({ version: "2.0" });

                //alert(PiNetworkClient);

                async function auth() {
                    try {
                        // Identify the user with their username / unique network-wide ID, and get permission to request payments from them.
                        const scopes = ['username', 'payments'];
                        function onIncompletePaymentFound(payment) {
                            
                            var data = {
                                    'action': 'complete',
                                    'paymentId': payment.identifier,
                                    'txid': payment.transaction.txid,
                                    'app_client': 'auth_example'
                                };
                            return $.post( "https://app.piwebinars.co.uk/server1.php", data).done(function(data) {
                                $("#button_click").prop( "disabled", false );
                            }).fail(function() {
                                $("#button_click").prop( "disabled", false );
                            });
                        }; // Read more about this in the SDK reference

                        Pi.authenticate(scopes, onIncompletePaymentFound).then(function(auth) {
                          $( "#button_click" ).click(function() {
                                if(parseFloat($("#pi_donate").val()) > 0)
                                {
                                    $("#button_click").prop( "disabled", true );
                                    /*setTimeout(function ()
                                    {
                                        $("#button_click").prop( "disabled", false );
                                    }, 10000);*/
                                    transfer();
                                }
                                //alert("Click");
                            });
                            //alert('Hello ' + auth.user.username);
                        }).catch(function(error) {
                          console.error(error);
                        });
                    } catch (err) {
                        alert(err);
                        // Not able to fetch the user
                    }
                }

                async function transfer() {
                    try {
                        const payment = Pi.createPayment({
                          // Amount of π to be paid:
                          amount: parseFloat($("#pi_donate").val()),
                          // An explanation of the payment - will be shown to the user:
                          memo: "Demo transfer request", // e.g: "Digital kitten #1234",
                          // An arbitrary developer-provided metadata object - for your own usage:
                          metadata: { paymentType: "donation" /* ... */ }, // e.g: { kittenId: 1234 }
                        }, {
                          // Callbacks you need to implement - read more about those in the detailed docs linked below:
                          onReadyForServerApproval: function(paymentId) {
                              var data = {
                                        'action': 'approve',
                                        'paymentId': paymentId,
                                        'txid': '',
                                        'app_client': 'auth_example'
                                    };
                              return $.post( "https://app.piwebinars.co.uk/server1.php", data).done(function(data) {
                                    $("#button_click").prop( "disabled", false );
                                }).fail(function() {
                                    $("#button_click").prop( "disabled", false );
                                });
                          },
                          onReadyForServerCompletion: function(paymentId, txid) {
                                var data = {
                                    'action': 'complete',
                                    'paymentId': paymentId,
                                    "txid": txid,
                                    'app_client': 'auth_example'
                                };
                                return $.post( "https://app.piwebinars.co.uk/server1.php", data).done(function(data) {
                                    $("#button_click").prop( "disabled", false );
                                }).fail(function() {
                                    $("#button_click").prop( "disabled", false );
                                });
                          },
                          onCancel: function(paymentId) { $("#button_click").prop( "disabled", false ); /* ... */ },
                          onError: function(error, payment) { $("#button_click").prop( "disabled", false ); /* ... */ },
                        });
                    } catch(err) {
                        $("#button_click").prop( "disabled", false );
                        alert(err);
                        // Technical problem (eg network failure). Please try again
                    }
                }

                auth();

            });
        </script>

    <script>
      const showWebinar = (id) => {
        const yt_frame = document.getElementById("youtube_frame");
        yt_frame.setAttribute("src", `https://www.youtube.com/embed/${id}`);
        yt_frame.style.display = "unset";
      }
    </script>
    
  <title>Pi Webinars</title>
 
<h1 >Pi Webinars</h1>
  
<img width="180" height="150" style="position:relative;top:0"
src="../img/logo.png"</img>
  
    <h4><span id="username"></span></h4><h5> Welcome to Pi Webinars, an educational video platform powered by Pi cryptocurrency.<br/></h5>
  
<nav class="footer" style="z-index: 100">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="html/search.html">Search</a></li>
    <li><a href="html/test.html">All Webinars</a></li>
    <li><a href="html/upload.html">Upload</a></li>
  </ul>
</nav>  
    
<h2 >Featured</h2>
 
  <div id="title"><h3>What is Value Investing?</h3>
  <p><i>In this lesson, students learn what value investing is.  The three course objectives are: 1) The difference between value trading and value investing 2) The difference between an asset and a liability 3) Who created and uses value investing.</i></p>
  <img src=https://img.youtube.com/vi/KfDB9e_cO4k/maxresdefault.jpg style="position:relative;top:0;width:100%"></div>
  <button onclick="Pi.createPayment();showWebinar('KfDB9e_cO4k');dataLayer.push({'event': 'KfDB9e_cO4k'});">Pay with Pi</button>
  
  <div id="title"><h3>South Korea: The Silent Cultural Superpower - Full Documentary</h3>
  <p><i>Rana Mitter finds out how South Korean culture manages to punch so far above its weight.</i></p>
  <img src=https://img.youtube.com/vi/6dGYVKt1zw4/maxresdefault.jpg style="position:relative;top:0;width:100%"></div>
  <button onclick="payPi();showWebinar('6dGYVKt1zw4');dataLayer.push({'event': '6dGYVKt1zw4'});">Pay with Pi</button>
  
  <div id="title"><h3>Winston Churchill ‘A Giant in The Century’ Documentary</h3>
  <p><i>How Winston Churchill turned the tables in the war and influenced the century to come.</i></p>
  <img src=https://img.youtube.com/vi/YIhYCRBDOUo/maxresdefault.jpg style="position:relative;top:0;width:100%"></div>
  <button onclick="Pi.createPayment(callbacks, paymentData);showWebinar('YIhYCRBDOUo');dataLayer.push({'event': 'YIhYCRBDOUo'});">Pay with Pi</button>
  
<h2 >Upcoming Live</h2>
  
<h5 >Live webinars coming soon...</h5><br/>
      
  </body>
  
  <h2>Watch Webinar:</h2>
  <iframe class="footer" id="youtube_frame" style="position:relative;top:0;width:100%;display:none" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  <h5><i>At mainnet, all webinars will be full length, high quality and origional to this site</i></h5>
  <br/><br/><br/><br/>
  
      </html>
